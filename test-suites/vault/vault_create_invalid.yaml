---
# Validates vault entry create.

authors:
  - Intesar Shannan Mohammed

type: ABSTRACT

endpoint: /vault

method: POST

requests:
  # invalid key - empty, dup
  - id: 1
    body:
      '{
         "key": "",
         "description": "",
         "val": "value",
         "visibility": "PRIVATE"
      }'
  - id: 2
    body:
      '{
         "key": "Duplicate-Key",
         "description": "",
         "val": "value",
         "visibility": "PRIVATE"
      }'
  # invalid val - empty
  - id: 3
    body:
      '{
         "key": "{{@Random | 6}}",
         "description": "",
         "val": "",
         "visibility": "PRIVATE"
      }'


assertions:
  - "@StatusCode == 200"
  - "@Response.errors == true"

tags:
  - SANDBOX

cleanup:
  - vault_delete
